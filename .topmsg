From: Marc Weber <marco-oweber@gmx.de>
Subject: [PATCH] experimental/overlays

allow finding overlays by name in same directory where nixpkgs is. This is nice for experimenting
Example: nixpkgs-haskell-overlay, nixpkgs-ruby-overlay (they do already work)
nixpkgs-python-overlay is planned

The reason for "overlays" is to keep nixpkgs modular. Some subuniverses such as python, scala, haskell, perl, ..
should be kept separate to reduce noise on the main repo - and because the
dumps of package sources (hackage, rubygems, pypi, ...) are quite large.


Now that NIX_PATH exists I'd like to use a function like this, but
interpolation is not supoprted yet (TODO)

  overlay = name:

    let np = <"nixpkgs-${name}-overlay">  #  <" .. ${} .. "> is not allowed
        fallback = (../../.. + "/nixpkgs-${name}-overlay")

    in if (builtins.builtins.pathExists np).success
       then np
       else if builtins.pathExists fallback
            then fallback
            else throw "overlay ${name} not found. See wiki how to get it"


The alternative is that fast that I'm not going to patch anything right now:

mkdir nix-repos;
ln -s /etc/nixos/nixpkgs nix-repos

Then you don't have to clone nixpkgs yourself

Signed-off-by: Marc Weber <marco-oweber@gmx.de>
